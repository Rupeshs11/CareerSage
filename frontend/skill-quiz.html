<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Skill Gap Analysis - CareerSage</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="css/style.css">
</head>

<body class="bg-[#0d1117] text-gray-300">

    <div class="flex flex-col min-h-screen">
        <!-- Header -->
        <div id="header-placeholder"></div>

        <!-- Main Content -->
        <main class="flex-1 overflow-y-auto">
            <div class="container mx-auto px-6 py-12 max-w-4xl">

                <!-- Quiz Header -->
                <div class="text-center mb-10">
                    <h1 class="text-4xl font-bold text-white mb-4">Skill Gap Analysis</h1>
                    <p class="text-gray-400 text-lg">Answer a few questions to identify your skill gaps and get
                        personalized recommendations.</p>
                </div>

                <!-- Progress Bar -->
                <div class="mb-8">
                    <div class="flex justify-between text-sm text-gray-400 mb-2">
                        <span>Question <span id="current-question">1</span> of <span
                                id="total-questions">5</span></span>
                        <span id="progress-percent">0%</span>
                    </div>
                    <div class="w-full bg-gray-800 rounded-full h-2">
                        <div id="progress-bar"
                            class="bg-gradient-to-r from-blue-500 to-purple-600 h-2 rounded-full transition-all duration-500"
                            style="width: 0%"></div>
                    </div>
                </div>

                <!-- Quiz Container -->
                <div id="quiz-container" class="bg-[#161b22] border border-gray-800 rounded-xl p-8">
                    <!-- Question will be dynamically inserted here -->
                </div>

                <!-- Results Container (Hidden initially) -->
                <div id="results-container" class="hidden">
                    <div class="bg-[#161b22] border border-gray-800 rounded-xl p-8 text-center">
                        <div
                            class="w-20 h-20 bg-gradient-to-br from-green-500 to-blue-500 rounded-full flex items-center justify-center mx-auto mb-6">
                            <svg class="w-10 h-10 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                        <h2 class="text-2xl font-bold text-white mb-4">Analysis Complete!</h2>
                        <p class="text-gray-400 mb-8">Based on your answers, here's your skill gap report:</p>

                        <!-- Skill Gaps -->
                        <div id="skill-gaps" class="text-left space-y-4 mb-8">
                            <!-- Will be populated dynamically -->
                        </div>

                        <!-- Score Summary -->
                        <div class="grid grid-cols-3 gap-4 mb-8">
                            <div class="bg-[#0d1117] rounded-lg p-4">
                                <p class="text-3xl font-bold text-green-500" id="score-strong">0</p>
                                <p class="text-gray-400 text-sm">Strong Skills</p>
                            </div>
                            <div class="bg-[#0d1117] rounded-lg p-4">
                                <p class="text-3xl font-bold text-yellow-500" id="score-moderate">0</p>
                                <p class="text-gray-400 text-sm">Need Improvement</p>
                            </div>
                            <div class="bg-[#0d1117] rounded-lg p-4">
                                <p class="text-3xl font-bold text-red-500" id="score-weak">0</p>
                                <p class="text-gray-400 text-sm">Skill Gaps</p>
                            </div>
                        </div>

                        <!-- Action Buttons -->
                        <div class="flex gap-4 justify-center">
                            <a href="./aisensie.html"
                                class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-8 rounded-lg transition-transform transform hover:scale-105">
                                Generate Personalized Roadmap
                            </a>
                            <button onclick="restartQuiz()"
                                class="bg-gray-700 hover:bg-gray-600 text-white font-bold py-3 px-8 rounded-lg">
                                Retake Quiz
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Navigation Buttons -->
                <div id="nav-buttons" class="flex justify-between mt-6">
                    <button id="prev-btn" onclick="prevQuestion()"
                        class="bg-gray-700 hover:bg-gray-600 text-white font-bold py-3 px-6 rounded-lg disabled:opacity-50 disabled:cursor-not-allowed"
                        disabled>
                        ← Previous
                    </button>
                    <button id="next-btn" onclick="nextQuestion()"
                        class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-6 rounded-lg disabled:opacity-50 disabled:cursor-not-allowed">
                        Next →
                    </button>
                </div>
            </div>
        </main>

        <!-- Footer -->
        <div id="footer-placeholder"></div>
    </div>

    <script src="js/api.js"></script>
    <script src="js/main.js" type="module"></script>
    <script>
        // Quiz Data
        const quizQuestions = [
            {
                id: 1,
                question: "How comfortable are you with HTML and CSS?",
                category: "Frontend Basics",
                options: [
                    { text: "I can build responsive layouts from scratch", value: 3 },
                    { text: "I understand the basics but need references", value: 2 },
                    { text: "I've used them a little", value: 1 },
                    { text: "I'm completely new to them", value: 0 }
                ]
            },
            {
                id: 2,
                question: "What's your experience with JavaScript?",
                category: "JavaScript",
                options: [
                    { text: "I'm proficient with modern ES6+ and frameworks", value: 3 },
                    { text: "I can write functions and manipulate the DOM", value: 2 },
                    { text: "I understand basic syntax", value: 1 },
                    { text: "Never used JavaScript", value: 0 }
                ]
            },
            {
                id: 3,
                question: "How familiar are you with version control (Git)?",
                category: "Version Control",
                options: [
                    { text: "I use Git daily with branching strategies", value: 3 },
                    { text: "I can commit, push, and pull", value: 2 },
                    { text: "I've heard of Git but rarely use it", value: 1 },
                    { text: "What is Git?", value: 0 }
                ]
            },
            {
                id: 4,
                question: "Do you have experience with any frontend framework?",
                category: "Frameworks",
                options: [
                    { text: "Yes, I've built projects with React/Vue/Angular", value: 3 },
                    { text: "I've completed tutorials", value: 2 },
                    { text: "I know what they are but haven't used them", value: 1 },
                    { text: "No experience with frameworks", value: 0 }
                ]
            },
            {
                id: 5,
                question: "How would you rate your problem-solving skills?",
                category: "Problem Solving",
                options: [
                    { text: "I regularly solve coding challenges", value: 3 },
                    { text: "I can debug issues with some research", value: 2 },
                    { text: "I struggle but eventually figure things out", value: 1 },
                    { text: "I find it very difficult", value: 0 }
                ]
            }
        ];

        let currentQuestionIndex = 0;
        let answers = {};

        // Initialize quiz
        document.addEventListener('DOMContentLoaded', function () {
            document.getElementById('total-questions').textContent = quizQuestions.length;
            renderQuestion();
        });

        function renderQuestion() {
            const question = quizQuestions[currentQuestionIndex];
            const container = document.getElementById('quiz-container');

            container.innerHTML = `
                <div class="mb-6">
                    <span class="inline-block bg-blue-500/20 text-blue-400 text-sm font-medium px-3 py-1 rounded-full mb-4">
                        ${question.category}
                    </span>
                    <h2 class="text-2xl font-bold text-white">${question.question}</h2>
                </div>
                <div class="space-y-3">
                    ${question.options.map((option, index) => `
                        <label class="block cursor-pointer">
                            <div class="flex items-center gap-4 p-4 rounded-lg border ${answers[question.id] === option.value ? 'border-blue-500 bg-blue-500/10' : 'border-gray-700 hover:border-gray-600'} transition">
                                <input type="radio" name="q${question.id}" value="${option.value}" 
                                    ${answers[question.id] === option.value ? 'checked' : ''}
                                    onchange="selectAnswer(${question.id}, ${option.value})"
                                    class="w-5 h-5 text-blue-600 bg-gray-700 border-gray-600 focus:ring-blue-500">
                                <span class="text-white">${option.text}</span>
                            </div>
                        </label>
                    `).join('')}
                </div>
            `;

            // Update progress
            updateProgress();
            updateNavButtons();
        }

        function selectAnswer(questionId, value) {
            answers[questionId] = value;
            updateNavButtons();

            // Re-render to update styling
            renderQuestion();
        }

        function updateProgress() {
            const progress = ((currentQuestionIndex) / quizQuestions.length) * 100;
            document.getElementById('progress-bar').style.width = progress + '%';
            document.getElementById('progress-percent').textContent = Math.round(progress) + '%';
            document.getElementById('current-question').textContent = currentQuestionIndex + 1;
        }

        function updateNavButtons() {
            const prevBtn = document.getElementById('prev-btn');
            const nextBtn = document.getElementById('next-btn');

            prevBtn.disabled = currentQuestionIndex === 0;

            const currentQuestion = quizQuestions[currentQuestionIndex];
            const hasAnswer = answers[currentQuestion.id] !== undefined;

            if (currentQuestionIndex === quizQuestions.length - 1) {
                nextBtn.textContent = 'Submit';
                nextBtn.onclick = submitQuiz;
            } else {
                nextBtn.textContent = 'Next →';
                nextBtn.onclick = nextQuestion;
            }
        }

        function nextQuestion() {
            const currentQuestion = quizQuestions[currentQuestionIndex];
            if (answers[currentQuestion.id] === undefined) {
                alert('Please select an answer before continuing.');
                return;
            }

            if (currentQuestionIndex < quizQuestions.length - 1) {
                currentQuestionIndex++;
                renderQuestion();
            }
        }

        function prevQuestion() {
            if (currentQuestionIndex > 0) {
                currentQuestionIndex--;
                renderQuestion();
            }
        }

        function submitQuiz() {
            const currentQuestion = quizQuestions[currentQuestionIndex];
            if (answers[currentQuestion.id] === undefined) {
                alert('Please select an answer before submitting.');
                return;
            }

            // Calculate results
            let strong = 0, moderate = 0, weak = 0;
            const gaps = [];

            quizQuestions.forEach(q => {
                const score = answers[q.id];
                if (score >= 3) {
                    strong++;
                } else if (score >= 2) {
                    moderate++;
                    gaps.push({ category: q.category, level: 'moderate', message: 'Some improvement needed' });
                } else {
                    weak++;
                    gaps.push({ category: q.category, level: 'weak', message: 'Significant gap identified' });
                }
            });

            // Save results to localStorage
            const result = {
                date: new Date().toISOString(),
                answers: answers,
                strong: strong,
                moderate: moderate,
                weak: weak,
                gaps: gaps
            };

            const existingResults = JSON.parse(localStorage.getItem('careersage_quiz_results') || '[]');
            existingResults.push(result);
            localStorage.setItem('careersage_quiz_results', JSON.stringify(existingResults));

            // Show results
            showResults(strong, moderate, weak, gaps);
        }

        function showResults(strong, moderate, weak, gaps) {
            document.getElementById('quiz-container').classList.add('hidden');
            document.getElementById('nav-buttons').classList.add('hidden');
            document.getElementById('results-container').classList.remove('hidden');

            // Update progress to 100%
            document.getElementById('progress-bar').style.width = '100%';
            document.getElementById('progress-percent').textContent = '100%';

            // Update scores
            document.getElementById('score-strong').textContent = strong;
            document.getElementById('score-moderate').textContent = moderate;
            document.getElementById('score-weak').textContent = weak;

            // Render skill gaps
            const gapsContainer = document.getElementById('skill-gaps');
            gapsContainer.innerHTML = gaps.map(gap => `
                <div class="flex items-center gap-4 p-4 rounded-lg ${gap.level === 'weak' ? 'bg-red-900/20 border border-red-800' : 'bg-yellow-900/20 border border-yellow-800'}">
                    <div class="w-10 h-10 rounded-full flex items-center justify-center ${gap.level === 'weak' ? 'bg-red-500/20' : 'bg-yellow-500/20'}">
                        ${gap.level === 'weak'
                    ? '<svg class="w-5 h-5 text-red-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path></svg>'
                    : '<svg class="w-5 h-5 text-yellow-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>'
                }
                    </div>
                    <div class="flex-1">
                        <h4 class="font-semibold ${gap.level === 'weak' ? 'text-red-400' : 'text-yellow-400'}">${gap.category}</h4>
                        <p class="text-gray-400 text-sm">${gap.message}</p>
                    </div>
                </div>
            `).join('');

            if (gaps.length === 0) {
                gapsContainer.innerHTML = `
                    <div class="flex items-center gap-4 p-4 rounded-lg bg-green-900/20 border border-green-800">
                        <div class="w-10 h-10 rounded-full flex items-center justify-center bg-green-500/20">
                            <svg class="w-5 h-5 text-green-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                            </svg>
                        </div>
                        <div>
                            <h4 class="font-semibold text-green-400">Great job!</h4>
                            <p class="text-gray-400 text-sm">You have a strong foundation in all areas assessed.</p>
                        </div>
                    </div>
                `;
            }
        }

        function restartQuiz() {
            currentQuestionIndex = 0;
            answers = {};
            document.getElementById('quiz-container').classList.remove('hidden');
            document.getElementById('nav-buttons').classList.remove('hidden');
            document.getElementById('results-container').classList.add('hidden');
            renderQuestion();
        }
    </script>
</body>

</html>